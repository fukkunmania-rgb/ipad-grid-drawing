<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no, maximum-scale=1, minimum-scale=1" />
    <title>iPad作画練習（ブラウザ版）</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="topbar">
      <div class="timer">
        <div class="progress-wrap">
          <div class="progress" id="progress"></div>
        </div>
        <div class="time-ctrls">
          <label>
            制限時間(秒)
            <input type="number" id="duration" min="10" max="3600" step="10" value="60" inputmode="numeric" />
          </label>
          <button id="startBtn" data-state="idle">スタート</button>
          <button id="giveUpBtn">ギブアップ</button>
          <span class="remain"><span id="remain">60</span> 秒</span>
        </div>
      </div>
      <div class="controls">
        <label class="file-btn">
          参照画像を選択
          <input type="file" id="refFile" accept="image/*" />
        </label>
        <label>
          グリッド
          <select id="gridDiv">
            <option value="0">なし</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5" selected>5</option>
          </select>
        </label>
        <label>
          グリッド太さ
          <input type="range" id="gridWidth" min="1" max="8" step="1" value="4" />
        </label>
        <label>
          ペン太さ
          <input type="range" id="penSize" min="1" max="12" value="3" />
        </label>
        <button id="clearBtn">クリア</button>
      </div>
    </header>

    <main class="workspace" id="workspace">
      <section class="pane" id="paneA" aria-label="参照キャンバス">
        <canvas id="canvasA" width="1448" height="2048"></canvas>
      </section>
      <section class="pane" id="paneB" aria-label="描画キャンバス">
        <canvas id="canvasB" width="1448" height="2048"></canvas>
        <canvas id="gridB" width="1448" height="2048" class="grid-layer"></canvas>
        <div class="overlay-msg" id="lockedMsg" hidden>タイムアップ：描画は終了しました</div>
      </section>
    </main>

    <section class="feedback" id="feedback" hidden aria-modal="true" role="dialog">
      <div class="feedback-toolbar">
        <label class="opacity-ctrl">A透明度
          <input type="range" id="aOpacity" min="0" max="100" step="1" value="50" />
        </label>
        <button id="saveBtn">縮小PNG保存（縦720px）</button>
        <button id="resetBtn">リセットして再開</button>
      </div>
      <div class="feedback-body">
        <div class="stack">
          <canvas id="fbA" width="1448" height="2048"></canvas>
          <canvas id="fbB" width="1448" height="2048"></canvas>
        </div>
        <canvas id="composite" width="1448" height="2048" style="display:none"></canvas>
      </div>
    </section>

    <script src="app.js"></script>
  </body>
  </html>

